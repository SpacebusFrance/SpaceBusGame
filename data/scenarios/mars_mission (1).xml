<?xml version="1.0" encoding="UTF-8"?>
<scenario>
    <group name="debut de jeux">
        <step action="set_screen" duration="0.0" name="go_to_mars"/>

        <!-- wait for key button pressed -->
        <step action="game_menu"/>
<!--        <step action="keyboard" key="control-enter"/>-->
<!--        <step action="play_sound" name="ok" duration="0"/>-->

        <step action="wait" duration="5"/>
        <step action="play_sound" name="human_0" duration="10"/>

<!--        <step action="led_on" led="antenne_com" duration="0"/>-->
        <!-- set chronometer and time limit -->
<!--        <event action="goto_step" goto_id="wrong_end" game_time="40"/>-->
<!--        <step action="start-chrono" time="40" duration="0"/>-->

<!--        <step action="start_game"/>-->
<!--        <step action="play_sound" name="human_0" duration="20"/>-->

        <!-- identification -->
        <step action="info" title="$id_info_title$" text="$id_info_text$" duration="20"/>
        <step action="password" password="RTJ108" title="$id_title$" text="$id_text_0$" icon="locked"/>
        <step action="password" password="24K18E" title="$id_title$" text="$id_text_1$" icon="locked"/>
        <step action="password" password="12AN4D" title="$id_title$" text="$id_text_2$" icon="locked"/>

        <!-- fermeture des portes -->
        <step action="wait" duration="2"/>
        <step action="play_sound" name="voice_door_close" volume="1.0" duration="1"/>
        <step action="play_sound" name="door_close" volume="1.0" duration="10"/>

        <!-- cible -->
        <step action="play_sound" name="human_target" duration="0"/>
        <!-- 180 = 3 MINUTES POUR LA BASE-->
        <step action="info" duration="20" title="$target_title_info$" text="$target_text_info$" icon="target"/>
        <step action="password" format="target" password="08:59:41" title="$target_title$" icon="target" text="$target_text_1$" hint_sound="human_hint_target" hint_time="180"/>
        <step action="password" format="target" password="55:47:24" title="$target_title$" icon="target" text="$target_text_2$" hint_sound="human_hint_target" hint_time="180"/>
        <step action="info" duration="4" title="$target_ok_title$" text="$target_ok_text$" icon="load_spinner" close_on_enter="False"/>

         <!--mise ne route des moteurs-->
        <step action="reset_leds" duration="1"/>
        <step action="play_sound" name="engine_starts" duration="2" volume="2.0"/>
        <step action="play_sound" name="human_1" duration="2"/>
        <step action="shuttle_look_at" x="0" y ="10" z="0"/>
        <step action="shuttle_goto" x="-2" y="10" z="1" power="30"/>
        <step action="shuttle_look_at" x="0" y="0" z="0"/>

        <!-- premier mouvement -->
        <step action="play_sound" name="human_2" duration="5"/>
        <step action="asteroid" duration="0"/>
        <step action="wait" duration="2.2"/>
        <step action="play_sound" name="start_music" duration="0"/>
        <step action="shuttle_goto" x="500" y="10" z="0" power="200" duration="12.5"/>

         <!--collision -->
        <step action="collision" duration="2"/>
        <step action="play_sound" name="alarm" duration="0" loop="True"/>
        <step action="warning" duration="10" title="$title_collision_info$" text="$text_collision_info$" close_on_enter="False"/>
        <step action="password" password="15Hu7" title="$title_collision_password$" text="$text_collision_password$"/>
        <step action="stop_sound" name="alarm"/>
    </group>
    <group name="partie joueur">
        <!-- emergency frequency -->
        <step action="play_sound" name="voice_emergency_freq" duration="10"/>

        <!-- enable hardware listening -->
        <step action="enable_hardware"/>

        <step action="info" duration="20" title="$title_procedure$" text="$text_procedure_pu2$"/>
        <step action="wait">
            <condition key="freq_comm" value="310"/>
        </step>

        <!--<step action="oxygen" time="800" value="0" game_time="0" duration="2"/>-->
<!--        <step action="oxygen_leak" duration="1"/>-->

        <step action="play_sound" name="bips" duration="0"/>
        <step action="led_on" led="antenne_com" duration="0"/>

        <!-- this time can be adapted -->
        <step action="play_sound" name="human_3" duration="7"/>
        <step action="play_sound" name="human_pu4" duration="18"/>

        <!-- PU4 -->
        <step action="info" life_time="20" title="$title_procedure$" text="$text_procedure_pu4$">
            <condition key="batteries" value="True"/>
            <condition key="batterie1" value="True"/>
            <condition key="batterie2" value="True"/>
            <condition key="batterie3" value="True"/>
            <condition key="batterie4" value="True"/>
        </step>
        <step action="wait" duration="3.0"/>
        <step action="play_sound" name="human_pu6"/>

        <!-- PU6 -->
        <step action="info" life_time="20" title="$title_procedure$" text="$text_procedure_pu6$">
            <condition key="thermique_secteur2" value="False"/>
            <condition key="thermique_secteur3" value="False"/>
            <condition key="oxygene_secteur2" value="False"/>
            <condition key="oxygene_secteur3" value="False"/>
            <condition key="tension_secteur2" value="False"/>
            <condition key="tension_secteur3" value="False"/>
            <condition key="recyclage_H2O" value="False"/>
            <condition key="recyclage_CO2" value="False"/>
            <condition key="recyclage_O2" value="False"/>
        </step>
        <step action="wait" duration="3.0"/>
        <step action="play_sound" name="human_pu7"/>

        <!-- PU7 -->
        <!-- 180 = 3 MINUTES POUR L"INDICE DES PANNEAUX-->
        <step action="info" life_time="20" title="$title_procedure$" text="$text_procedure_pu7$" hint_sound="human_hint_pu7" hint_time="180">
            <condition key="offset_ps_x" value="0.0"/>
            <condition key="offset_ps_y" value="0.0"/>
        </step>

         <!--PA1 -->
        <step action="play_sound" name="human_p_a_1" duration="9"/>
        <step action="info" life_time="20" title="$title_procedure$" text="$text_procedure_pa1$">
            <condition key="pilote_automatique1" value="True"/>
        </step>

        <!-- PA2 -->
        <step action="wait" duration="2.0"/>
        <step action="play_sound" name="human_p_a_2" duration="4"/>

        <step action="wait" duration="5.0"/>
        <step action="info" life_time="20" title="$title_procedure$" text="$text_procedure_pa2$">
            <condition key="pilote_automatique2" value="True"/>
        </step>
        <step action="disable_hardware"/>

    </group>

    <group name="good end">
        <step action="wait" duration="2.0"/>
        <step action="play_sound" name="human_p_a_ok" duration="10"/>
        <step action="led_off" led="alert0"/>
        <step action="led_off" led="alert1"/>

        <!-- LAST MOVE -->
        <step action="play_sound" name="end_music" duration="0"/>
        <step action="shuttle_look_at" x="0" y="-10" z="0" time="10"/>
        <step action="control_screen_event" name="image_screen" image_name="end" duration="0"/>

        <step action="boost" direction="f" power="20" duration="0"/>
        <step action="wait" duration="10"/>

        <step action="end_game"/>
<!--        <step action="control_screen_event" name="image_screen" image_name="score" duration="0"/>-->
<!--        <step action="show_score"/>-->
        <step action="wait" duration="10"/>

        <step action="play_sound" name="human_end" duration="0"/>

        <!-- RESTART GAME -->
        <step action="wait">
            <end_conditions>
                <condition key="b_admin" value="True"/>
            </end_conditions>
        </step>
        <step action="restart"/>
    </group>

    <!--    This should not be reached until time end -->
    <group id="wrong_end">
        <step action="info" title="end of game !!!" text="this should be the end of game ..." duration="5"/>

        <step action="end_game"/>

        <!-- RESTART GAME -->
        <step action="wait">
            <end_conditions>
                <condition key="b_admin" value="True"/>
            </end_conditions>
        </step>
        <step action="restart"/>
<!--        <event action="back_to_menu"/>-->
    </group>
</scenario>
